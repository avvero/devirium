![alt text](Methodcentipede.png)

---
Было ли у вас такое, что вы маленький лежите на кровати и смотрите на стену, где весит старый советский ковер с замысловатыми рисунками и видите как в этих линиях отчетливо вырисовываются животные и прочие причудливые формы? 
Сейчас я смотрю больше в код, но в моем сознании все так же возникают удивительные образы. Эти образы бывают приятными и не очень. Но не зависимо от эстетической составляющей, все эти образы складываются в повторяющиеся паттерны. Часть из них прекрасны, а часть из них безобразны. Об одном из таких паттернов я бы хотел поговорить в этом небольшой статье.

---

Помните, как в детстве вы лежали на кровати и смотрели на старый советский ковер с замысловатыми узорами, видя, как в этих линиях отчетливо вырисовываются животные и причудливые формы? Теперь я чаще смотрю на код, но в моем сознании по-прежнему возникают удивительные образы. Эти образы могут быть как приятными, так и не очень. Но независимо от их эстетической привлекательности, все они складываются в повторяющиеся паттерны. Одни из них прекрасны, а другие безобразны. О одном из таких 'безобразных' паттернов я бы хотел рассказать в этой небольшой статье.

---

## Сценарий 

Давайте представим, что в наши руки попал сервис, который в том числе обрабатывает запрос на регистрацию клиента и отправляет событие о завершении регистрации в кафку. 

Предлагаю разобрать два вариант реализации, сравнить их.

## Первый вариант реализации: Methodcentipede

Схема представлена ниже.
```plantuml
@startuml
skinparam rectangular true

[registerClient] --> [sendEvent]: Client object
[sendEvent] --> [kafkaTemplate.send]: Message object

@enduml
```

Код
```

```

Первое наблюдение такое: Из методов формируется неразрывная цепочка по которой движется перетекающая масса данных. Код разделен на методы таким образом, что весь процесс обработки просто вытянуть в некий пайплайн данных и нарезан на методы. Цепочка не разрывна, методы в середине цепочке реализует не только логику, непосредственно включенного в него кода, но и всю логику вызываемым им методов. 

Все методы следующие перед вызываемым наследуют всю сложность, например если kafkaTemplate.send является не чистой функцией (есть сайд эффект), то то и вызывающий его sendEvent чисто функцией не является и наследует сайд эффект.

отвечает за свою логику плюс за ту логику, что идет следом. 


Логика будто бы разделена, но за счет того, что это все сцеплено вместе



Из методов формируется неразрывная цепочка вдоль которой проталкивается перетекающаяся масса данных. 

## Второй вариант реализации

Схема представлена ниже.
```plantuml
@startuml
skinparam rectangular true

component registerClient
component mapToEventMessage
component kafkaTemplate.send

[registerClient] --> [mapToEventMessage]
[registerClient] --> [kafkaTemplate.send]

@enduml
```

Код
```

```

Код метода обработки описанного запроса представлен ниже.



Методы атрофируются с точки зрения ответственности, границы которой в общейй цепочке размыты. При этом методы сохраняют собственные названия. Но вляются ничем иным, как частью пайплайна.

Тестирование затруднено тем, что мы вынуждены тестировать иили всю цепочку следующих методов, учитывая особенности (сайд эффекты и прочую недетрминипованность)

Цель стремиться к методам с четкой ответственность, к чистым функциям.

===

проблема с поддержкой, придумать сценарий - когда будет плохо, например отправляем не для всех клиентов

---
Сосидж дизайн
Как сосиска растянутый код

Sausage links design 

Человеческая многоножка, скрин из сауспарка

Human Centipede - Method Centipede
Нарисовать на планшете набросок и попросит гпт дорисовать. Нужно повторить стиль сауспарка но с методами.
Найти хороший пример 

--
Я придумал дурацкие названия для антипартернов 
Я встречаю повторяющиеся паттерны кода, которые я считаю не правильным и придумываю им дурацкие названия.

#draft #design